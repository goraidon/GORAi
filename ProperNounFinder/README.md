# OpenAI API 固有名詞検出・置換ツール

このプロジェクトは、OpenAI APIを使用してCSVファイル内のテキストから固有名詞を検出し、一般的な表現に置き換える処理を行います。

## 使用モデル

デフォルトでGPT-4oを使用します。GPT-4oは以下の特徴があります：
- より高精度な日本語理解
- 固有名詞の検出精度向上
- JSON形式での応答の安定性向上

## ディレクトリ構造

```
PROJECTS/TEST/
├── input/           # 入力CSVファイルを配置
├── output/          # 処理結果CSVファイルが出力
├── config/          # API設定ファイル
│   ├── api_config.py
│   └── env_template.txt
├── prompts/         # プロンプト管理
│   └── prompts.py
├── scripts/         # 実行スクリプト
│   └── main.py
├── requirements.txt # 依存関係
└── README.md        # このファイル
```

## セットアップ

### 1. 依存関係のインストール

```bash
cd プロジェクトディレクトリ
pip install -r requirements.txt
```

### 2. 環境変数の設定

1. `config/env_template.txt` を参考に、プロジェクトルートに `.env` ファイルを作成
2. OpenAI APIキーを設定

```bash
# プロジェクトルートに .env ファイルを作成
cp config/env_template.txt .env

# .env ファイルを編集してAPIキーを設定
# OPENAI_API_KEY=your_actual_api_key_here
```

### 3. 入力CSVファイルの準備

`input/` ディレクトリに処理したいCSVファイルを配置してください。
ファイルが存在しない場合、初回実行時にサンプルファイルが自動作成されます。

## 使用方法

### 基本的な実行

```bash
cd プロジェクトディレクトリ
python scripts/main.py
```

または実行スクリプトを使用：

```bash
./run.sh
```

### 処理内容

このツールは以下の処理を行います：

1. **固有名詞検出**: 各セルのテキストに固有名詞が含まれているかを判定
2. **理由記載**: 判定した理由を日本語で記載
3. **固有名詞リスト**: 検出された固有名詞をリスト化
4. **置換文章生成**: 固有名詞を一般的な表現に置き換えた文章を生成

### 出力形式

入力CSVの各カラム `column_name` に対して、以下のカラムが追加されます：

- `column_name_original`: 元のテキスト
- `column_name_contains_proper_noun`: 固有名詞が含まれているか（True/False）
- `column_name_reason`: 判定理由
- `column_name_proper_nouns`: 検出された固有名詞のリスト
- `column_name_replaced_text`: 置換後の文章

## 固有名詞の定義

このツールでは以下を固有名詞として検出します：

- 人名（実在・架空問わず）
- 地名（国名、都市名、地域名など）
- 会社名・組織名・ブランド名
- 商品名・サービス名
- 映画・書籍・楽曲などの作品名
- その他特定の固有の名称

## 置き換え例

- 人名 → "ある人"、"その人"、"彼/彼女"
- 会社名 → "ある会社"、"その企業"
- 地名 → "ある地域"、"その場所"
- 商品名 → "ある商品"、"その製品"

## トラブルシューティング

### APIキーエラー
- `.env` ファイルが正しく作成されているか確認
- `OPENAI_API_KEY` が正しく設定されているか確認

### CSVファイルが見つからない
- `input/` ディレクトリにCSVファイルが配置されているか確認
- ファイル名に日本語が含まれている場合は英数字に変更を推奨

### JSON解析エラー
- APIからの応答が不正な場合に発生
- モデルを変更するか、プロンプトを調整してください 

## 注意事項

- OpenAI APIの利用料金が発生します
- 大量のデータを処理する場合は、APIの使用制限にご注意ください
- 処理時間はデータ量とAPIの応答速度によって変わります
- このプロジェクトは学習目的で作成されました
- 本格的な運用には適していません
- セキュリティやエラーハンドリングが不十分な場合があります

## ライセンス

このプロジェクトは学習目的で作成されており、**コントリビューションやサポートは受け付けておりません**。

参考目的での利用は自由ですが、商用利用や本格的な運用は推奨しません。 